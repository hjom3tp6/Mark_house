<script>
  import liff from "@line/liff";
  import { fade } from "svelte/transition";
  import Pic from "./component/Pic.svelte";
  import { myPic, myName } from './stores.js';

  let isInClient = false;
  let liffInit = initLiff();

  async function initLiff() {
    await liff
      .init({
        liffId: "1654061887-ZoYpPWL2",
      })
      .then(() => {
        // start to use LIFF's api
        displayLiffData();
      })
      .catch((err) => {
        window.alert("請檢察網路連線問題");
	  });
	  
	  await liff
      .getProfile()
      .then((profile) => {
        myName.set(profile.displayName);
        myPic.set(profile.pictureUrl);
      })
      .catch((err) => {
        console.log("error", err);
  });
  }
  //   onMount(initLiff());
  /**
   * Display data generated by invoking LIFF methods
   */
  function displayLiffData() {
    isInClient = liff.isInClient();
  }
</script>

<style>
.box-component {
	width: 80%;
	margin: auto;
	display: flex;
	justify-content: center;
	align-items: center;
}

</style>
{#await liffInit}
  <div />
{:then}
  {#if !isInClient}
    <h1>請移至line中開啟</h1>
  {:else}
    <div class="box-component" transition:fade>
      <Pic />
    </div>
  {/if}
{:catch error}
  <p>{error.message}</p>
{/await}
